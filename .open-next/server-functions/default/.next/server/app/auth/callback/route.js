(()=>{var e={};e.id=15,e.ids=[15],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11997:e=>{"use strict";e.exports=require("punycode")},27910:e=>{"use strict";e.exports=require("stream")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},29784:()=>{},30456:()=>{},34631:e=>{"use strict";e.exports=require("tls")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},58744:(e,r,t)=>{"use strict";t.d(r,{U:()=>a});var s=t(57566),o=t(4926);let a=async()=>{let e=await (0,o.UL)();return(0,s.createServerClient)("https://zadurpfbjkbqnylfmsxc.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InphZHVycGZiamticW55bGZtc3hjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDI5NjM0NDcsImV4cCI6MjA1ODUzOTQ0N30.NmPVqzuXTvvPdRKC2_yHhnDL5xVh1g3omN1R1U95Hd8",{cookies:{getAll:()=>e.getAll(),setAll(r){try{r.forEach(({name:r,value:t,options:s})=>{e.set(r,t,s)})}catch(e){}}}})}},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},74075:e=>{"use strict";e.exports=require("zlib")},79428:e=>{"use strict";e.exports=require("buffer")},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},83757:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>h,routeModule:()=>p,serverHooks:()=>x,workAsyncStorage:()=>l,workUnitAsyncStorage:()=>d});var s={};t.r(s),t.d(s,{GET:()=>u});var o=t(42684),a=t(75041),i=t(17688),n=t(58744),c=t(65653);async function u(e){let r=new URL(e.url),t=r.searchParams.get("code"),s=r.origin,o=r.searchParams.get("next")??"/protected",a=r.searchParams.get("platform"),i=r.searchParams.get("browser"),u=r.searchParams.get("location");if(!t)return console.error("No code provided in OAuth callback"),c.NextResponse.redirect(`${s}/?error=true&message=Missing+authorization+code&type=error`);try{let r,p=await (0,n.U)(),{error:l,data:d}=await p.auth.exchangeCodeForSession(t);if(l)return console.error("Error exchanging code for session:",l.message),c.NextResponse.redirect(`${s}/?error=true&message=${encodeURIComponent(l.message)}&type=error`);if(d?.user)try{let e={platform:a||"unknown",browser:i||"unknown",location:u||"unknown"},{data:r,error:t}=await p.rpc("update_user_profile_metadata",{user_id:d.user.id,p_platform:e.platform,p_browser:e.browser,p_location:e.location});t?console.error("Error updating profile:",t.message):console.log("Profile updated successfully"),await p.auth.updateUser({data:{platform:e.platform,browser:e.browser,location:e.location,last_sign_in:new Date().toISOString()}})}catch(e){console.error("Error updating user profile:",e)}let x=e.headers.get("x-forwarded-host");return r=x?`https://${x}${o}`:`${s}${o}`,c.NextResponse.redirect(r)}catch(e){return console.error("Unexpected error in OAuth callback:",e),c.NextResponse.redirect(`${s}/?error=true&message=An+unexpected+error+occurred&type=error`)}}let p=new o.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/auth/callback/route",pathname:"/auth/callback",filename:"route",bundlePath:"app/auth/callback/route"},resolvedPagePath:"/workspaces/opendots1.0/app/auth/callback/route.ts",nextConfigOutput:"standalone",userland:s}),{workAsyncStorage:l,workUnitAsyncStorage:d,serverHooks:x}=p;function h(){return(0,i.patchFetch)({workAsyncStorage:l,workUnitAsyncStorage:d})}},91645:e=>{"use strict";e.exports=require("net")},94735:e=>{"use strict";e.exports=require("events")}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[951,977,432],()=>t(83757));module.exports=s})();